<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Chapter 2-DAILY LIFE</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet"/>
  <style>

    body {
      font-family: 'Noto Sans KR', sans-serif;
      background-color: #f5f5f5;
      color: black;
      text-align: center;
      padding: 2em;
    }
    .hidden { display: none; }

#user-display {
  position: fixed;
  top: 10px;
  left: 10px;
  z-index: 9999;
  display: flex;
  align-items: center;
  background-color: #F5F5F5;
  padding: 8px 12px;
  border-radius: 8px;
  box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.15);
  font-family: monospace;
  color: #3F40D3;
  border: 1px solid #ddd;
  min-width: 180px;
}

#persistent-nav {
  position: fixed;
  top: 110px;
  left: 10px;
  z-index: 9999;
  display: none;
  flex-direction: column;
  gap: 4px; /* 버튼 사이 간격 줄임 */
  background-color: #F5F5F5;
  padding: 6px 8px; /* 네모 자체 여백 줄임 */
  border-radius: 6px;
  box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.15);
  border: 1px solid #ddd;
  min-width: 140px; /* 폭도 작게 */
}

#persistent-nav button {
  background-color: #3F40D3;
  color: white;
  border: none;
  border-radius: 4px;
  padding: 4px 6px;     /* 버튼 내부 여백 줄임 */
  margin: 0;            /* 버튼 외부 여백 제거 */
  cursor: pointer;
  font-family: inherit;
  font-size: 12px;      /* 글자 크기 줄임 */
  transition: background-color 0.2s ease;
}

#persistent-nav button:hover {
  background-color: #2c2db2;
}

#barcode-icon {
  width: 60px;
  height: 40px;
  margin-right: 10px;
}

#user-text > div {
  font-size: 14px;
  line-height: 1.4;
  color: #3F40D3;  /* 혹시 상속이 안 될 수도 있으니 명시 */
}
    #bgm-player {
      position: fixed;
      top: 10px;
      right: 10px;
      background: rgba(255, 255, 255, 0.8);
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
    #bgm-player button {
      background-color: #3f40d3 !important;
      color: white;
    }

    .fade-in {
      animation: fadein 1.2s ease-in;
            }
  
    @keyframes fadein {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .typewriter {
      font-weight: bold;
      font-size: 1.1em;
      white-space: nowrap;
      overflow: hidden;
      border-right: 2px solid #3f40d3;
      width: 0;
      animation: typing 3s steps(30, end) forwards, blink 0.75s step-end infinite;
      margin-bottom: 1em;
    }

    @keyframes typing {
      from { width: 0; }
      to { width: 100%; }
    }

    @keyframes blink {
      50% { border-color: transparent; }
    }

    @keyframes pop {
    0% { transform: scale(0.7); opacity: 0; }
    60% { transform: scale(1.1); opacity: 1; }
    100% { transform: scale(1); }
  }

  #drink-result {
    animation: pop 0.6s ease-out;
    transition: all 0.2s ease;
  }
  
    button {
      font-size: 1em;
      padding: 10px 20px;
      margin: 10px;
      border: none;
      background-color: #3f40d3;
      color: white;
      border-radius: 10px;
      cursor: pointer;
    }
    button:hover {
      background-color: #2c2db2;
    }
    .nav-button {
      background-color: #444 !important;
      font-size: 0.85em !important;
      padding: 5px 12px !important;
    }
    .logo {
      width: 200px;
      margin-bottom: 1em;
    }
  </style>
</head>

<!-- !!!!여기서부터 BODY!!!! -->
<body>
  <!-- 유저 디스플레이 -->
<div id="user-display">
  <img src="zzapbarcode.png" alt="barcode" id="barcode-icon">
  <div id="user-text">
    <p id="user-class-line">User ID : UNKNOWN</p>
    <p id="coin-line">Coin : ???</p>
  </div>
</div>
  <!-- 브금 플레이어 -->
  <div id="bgm-player">
    <audio id="bgm" src="zzapbgm.mp3" loop></audio>
    <button onclick="document.getElementById('bgm').play()">▶</button>
    <button onclick="document.getElementById('bgm').pause()">⏸</button>
  </div>
  
  <!-- 로고 -->
  <img class="logo" src="zzaplogo.png"/>
  
  <!-- 내비게이션 -->
  <div id="persistent-nav">
  <button onclick="goTo('main-page-2nd')">메인 화면</button>
  <button onclick="goTo('guide')">조사 가이드</button>
  <button onclick="goTo('starting-point')">건물 입구로</button>
</div>
  
<!-- main-page 버튼 이미지 배치 -->
<div id="main-page" class="hidden" style="position: relative; height: 100vh; background-color: #f5f5f5;">
  <!-- Initiation -->
  <img src="initiation.png" class="menu-button initiation" loading="lazy" onclick="goTo('starting-point')" alt="시작">
  <!-- Guide -->
  <img src="guide.png" class="menu-button guide" loading="lazy" onclick="goTo('guide')" alt="가이드">
  <!-- Report -->
  <img src="report.png" class="menu-button report" loading="lazy" onclick="goTo('report')" alt="종료">
</div>
<style>
  .menu-button {
    position: absolute;
    cursor: pointer;
    transform-style: preserve-3d;
    transform: translateX(0) scale(1); /* 애니메이션 최종 위치 */
    transition: transform 0.4s ease;
    opacity: 0;
    pointer-events: none; /* 애니메이션 끝날 때까지 hover 방지 */
  }
  /* Initiation 버튼 */
  .initiation {
    top: 1%;
    left: 39%;
    width: 12%;
    height: auto;
    animation-name: slideInLeft;
    animation-duration: 1.2s;
    animation-delay: 0.2s;
    animation-fill-mode: forwards;
    animation-timing-function: ease-out;
  }
  /* Guide 버튼 */
  .guide {
    top: 17%;
    right: 40%;
    width: 14%;
    height: auto;
    animation-name: slideInRight;
    animation-duration: 1.2s;
    animation-delay: 0.3s;
    animation-fill-mode: forwards;
    animation-timing-function: ease-out;
  }

  /* Report 버튼 */
  .report {
    top: 36%;
    left: 39%;
    width: 15%;
    height: auto;
    animation-name: slideInLeft;
    animation-duration: 1.2s;
    animation-delay: 0.4s;
    animation-fill-mode: forwards;
    animation-timing-function: ease-out;
  }

  /* 등장 애니메이션 정의 */
  @keyframes slideInLeft {
    0% {
      transform: translateX(-80%) scale(0.9);
      opacity: 0;
    }
    100% {
      transform: translateX(0) scale(1);
      opacity: 1;
    }
  }

  @keyframes slideInRight {
    0% {
      transform: translateX(80%) scale(0.9);
      opacity: 0;
    }
    100% {
      transform: translateX(0) scale(1);
      opacity: 1;
    }
  }
/* 공통 Hover 발광 효과 */
.initiation:hover,
.guide:hover,
.report:hover {
  filter: drop-shadow(0 0 8px rgba(63, 64, 211, 0.6)); /* #3F40D3 계열 빛 */
  transition: filter 0.4s ease-in-out;
}

</style>

<!-- !!!!여기서부터 작동시킬 페이지들!!!! -->
  <!-- 로그인 화면 -->
  <div id="login-page">
    <p>ID를 입력하세요.</p>
    <input id="id-input" type="text" />
    <button onclick="checkLogin()">확인</button>
    <p id="login-error" style="color: #ff4444;"></p>
  </div>

    <!-- guide 페이지 -->
<div id="guide" class="hidden" style="padding: 3em; text-align: left; text-align: left; max-width: 700px; margin: 0 auto; background: white; border: 3px solid #3f40d3; border-radius: 10px; color: black;">
  <p><span style="font-weight: bold; color: #3f40d3;">조사 가이드</span><br><br><br>
    웹에서는 클릭, 모바일에서는 터치로 진행합니다. 자유롭게 종료하고 재실행하셔도 좋지만, 창을 닫거나 뒤로가기/새로고침할 시 진행 경과가 초기화되니 주의해 주세요.<br>
    본 조사는 별도의 서버를 사용하지 않기 때문에 세션을 종료하면 결과가 저장되지 않습니다.<br><br>
    메인 화면에서 '조사 종료→조사 마치기' 를 클릭하면 획득 코인을 알려 주는 화면이 표시됩니다. 최종 화면을 표시한 후에는 이전으로 돌아갈 수 없습니다.<br>
    최종 화면을 스크린 캡처하여 총괄계 DM으로 보내 주시면 조사 완료 처리됩니다.</p>
    <br>
    <button class="nav-button" onclick="goBack()">나가기</button>
</div>

  <!-- 레포트 주의사항 -->
  <div id="report" class="hidden">
    <p>모든 조사를 마치고 최종 리포트를 작성합니다. 진행할 시 이전 단계로 되돌아갈 수 없습니다.<br>조사를 마칠까요?</p>
    <button onclick="loadFinalReport()">조사를 마친다</button><br>
    <button class="nav-button" onclick="goBack()">취소</button>
  </div>
  
  <!-- 뒤로가기 적용된 메인 페이지 -->
<div id="main-page-2nd" class="hidden" style="position: relative; height: 100vh; background-color: #f5f5f5;">
  <!-- Initiation -->
  <img src="initiation.png" class="menu-button initiation" onclick="goBack()" alt="시작">
  <!-- Guide -->
  <img src="guide.png" class="menu-button guide" onclick="goTo('guide')" alt="가이드">
  <!-- Report -->
  <img src="report.png" class="menu-button report" onclick="goTo('report')" alt="종료">
  </div>
  
  <!-- 스타팅 포인트 -->  
  <div id="starting-point" class="hidden">
    <p><span style="font-weight: bold;">[건물 입구]</span><br><br>흰 관을 연상시키는 건물. 그 입구에 다다른다.<br>돌로 된 정문 표면에는 알 수 없는 문자가 빼곡히 음각으로 새겨져 있다.<br>건물 바깥은 이미 충분히 돌아보았으니 오늘은 새로 공개된 장소 위주로 탐색해 보자.</p>
    <button onclick="goTo('inside')">건물 안으로 들어간다</button>
  </div>

  <!-- 내부 1층 --> 
  <div id="inside" class="hidden">
    <p><span style="font-weight: bold;">[건물 1층]</span><br><br>대리석 바닥이 반짝거리는 건물 1층.<br>정면에 방문객을 맞이하는 <span style="color: #3f40d3;">로비</span>가 보이고, 로비 뒤편에는 뒤편에는 유리로 된 <span style="color: #3f40d3;">엘리베이터</span>가 배치되어 있어 시선이 저절로 천장을 향한다.<br>더 안쪽에 있는 복도는 <span style="color: #3f40d3;">레스토랑</span>으로 이어지는 듯하다.</p>
    <button onclick="goTo('lobby')">로비</button>
    <button onclick="goTo('elevator')">엘리베이터</button>
    <button onclick="goTo('restaurant')">레스토랑</button><br>
    <button class="nav-button" onclick="goTo('starting-point')">건물 입구로 돌아가기</button>
  </div>

      <!-- 로비:엘리베이터:탑승 --> 
    <div id="elevator" class="hidden">
    <p><span style="font-weight: bold;">[엘리베이터]</span><br><br>원하는 층으로 이동할 수 있다.<br>하지만 4층 이상부터는 정비 중인지, 버튼을 눌러도 불이 들어오지 않는다.</p>
      <button onclick="goToWithSound('3rdfloor','zzapelevator.mp3')">3층</button><br>
    <button onclick="goToWithSound('2ndfloor','zzapelevator.mp3')">2층</button><br>
      <button onclick="goToWithSound('inside','zzapelevator.mp3')">1층</button><br>
 </div>     
  
    <!-- 로비 --> 
    <div id="lobby" class="hidden">
    <p><span style="font-weight: bold;">[로비]</span><br><br>건물에 들어오면 가장 먼저 보게 되는 곳.<br>우아한 석조 <span style="color: #3f40d3;">카운터</span>를 중심으로 내빈을 위한 라운지가 마련되어 있다.</p>
    <button onclick="goTo('counter')">카운터</button><br>
    <button class="nav-button" onclick="goTo('inside')">나가기</button>
  </div>

    <!-- 로비:카운터 --> 
    <div id="counter" class="hidden">
    <p><span style="font-weight: bold;">[로비]<br>[카운터]</span><br><br>보통이라면 직원이 서 있어야 할 카운터 너머에는 아무도 없다. 가까이 다가가자 공증인의 목소리가 울린다.<br><br><em>"좋은 하루 보내고 계신가요?"</em><br><br><em>"이번에도 작은 퀴즈를 준비했습니다. 유언 집행을 위한 기력 충전에 도움이 되었으면 좋겠군요."</em></p>
    <button onclick="goTo('notary')">공증인과 대화하기</button><br>
    <button class="nav-button" onclick="goTo('lobby')">나가기</button>
 </div>
  
    <!-- 로비:카운터:notary --> 
    <div id="notary" class="hidden">
    <p><span style="font-weight: bold;">[로비]/[카운터]<br>[공증인]</span><br><br>스피커를 통해 흘러나오는 목소리는 정중하지만, 마냥 신뢰할 수는 없다...<br><em>"어떤 일을 도와드릴까요?"</em></p>
    <button id="nota1" onclick="goTodel('notary1', 'nota1')">로렘의 유언에 대해서</button><br>
    <button id="nota2" onclick="goTodel('notary2', 'nota2')">기록체에 대해서</button><br>
    <button onclick="goTo('notary4')">퀴즈를 푼다</button><br>
    <button class="nav-button" onclick="goTo('counter')">대화를 끝낸다</button>
 </div>
  
    <!-- 로비:카운터:notary1 --> 
    <div id="notary1" class="hidden">
    <p><span style="font-weight: bold;">[로비]/[카운터]<br>[공증인]</span><br><br><em>"로렘 님께서 작성하신 유언을 한 치의 오차 없이 낭독해 드렸습니다.<br>믿기 어려워하시는 유언집행자 분들이 많으신 듯해 유감입니다만...<br>그렇다고 유언을 집행하지 않을 수도 없는 노릇이지요."</em></p>
    <button class="nav-button" onclick="goTo('notary')">다른 이야기</button>
 </div>
  
    <!-- 로비:카운터:notary2 --> 
    <div id="notary2" class="hidden">
    <p><span style="font-weight: bold;">[로비]/[카운터]<br>[공증인]</span><br><br><em>"기록체는 고인의 기억이나 성격을 기반으로 새로운 아웃풋을 도출하기도 합니다.<br>실로 놀라운 기술이지요. 여러분께 선보일 수 있어 영광입니다."</em></p>
    <button class="nav-button" onclick="goTo('notary')">다른 이야기</button>
 </div>

      <!-- 로비:카운터:notary4 --> 
    <div id="notary4" class="hidden">
    <p><span style="font-weight: bold;">[로비]/[카운터]<br>[공증인]</span><br><br><em>"그럼 문제입니다. 미래기관 대출 순위 1위 도서의 제목을 알고 계신가요?"</em><br><br>정확한 제목을 괄호 없이 입력하자.</p>
    <input type="text" id="secret-code-input">
    <div id="codebox">
    <button onclick="checkSecretCode()">확인</button>
  </div>
    <p id="secret-code-result"></p>
    <button class="nav-button" onclick="goTo('notary')">다른 이야기</button>
 </div>
  
      <!-- 로비:카운터:notary5 --> 
    <div id="notary5" class="hidden">
    <p><span style="font-weight: bold;">[로비]/[카운터]<br>[공증인]</span><br><br><em>"정답입니다. 한 번 빌려 보시는 것은 어떤가요?"</em><br><br>짝짝짝, 박수 소리가 울리나 싶더니 어느새 카운터 위에 동전 두 개가 놓여 있다. 퀴즈를 맞힌 보상인 것 같다.<br><span style="font-weight: bold;">2코인을 획득했다.</span></p>
    <button class="nav-button" onclick="goTo('notary')">다른 이야기</button>
 </div>
  
    <!-- 레스토랑 --> 
    <div id="restaurant" class="hidden">
    <p><span style="font-weight: bold;">[레스토랑]</span><br><br>이곳에 모인 초세계급들의 식사를 책임지는 레스토랑. 식사를 하며 바깥 풍경을 바라볼 수 있도록 유리창이 나 있다.
    <br>전에 보았던 것과 크게 달라진 점은 없지만, <span style="color: #3f40d3;">"음료 디스펜서는 3층의 영화관으로 이전했습니다"</span> 라는 안내문이 붙어 있다.</p>
      <button class="nav-button" onclick="goTo('inside')">나가기</button>
  </div>

  <!-- 영화관 : 음료 디스펜서 --> 
  <div id="dispenser" class="hidden">
  <p><span style="font-weight: bold;">[레스토랑]/[음료 디스펜서]</span><br><br>
  커피나 차 등의 음료를 자유롭게 이용 가능한 디스펜서.<br>기본적인 음료는 물론, 여러 가지 맛의 원두와 티백, 시럽도 비치되어 있어 얼마든지 원하는 음료를 제조 가능할 것 같다.<br>
  한쪽에는 '랜덤 디스펜서 : 1일 3회 이용 가능' 이라고 적힌 익숙한 상자가 있다.<br>그 옆에는 '랜덤 음료 공모전' 이라고 적힌 투표함이 놓여 있다.</p>
  <button onclick="goTo('dispenser1')">음료를 뽑는다</button>
  <button onclick="goTo('dispenser2')">랜덤 음료 공모전</button><br>
  <button class="nav-button" onclick="goTo('cinema')">나가기</button>
  </div>
  
  <!-- 영화관 : 음료 디스펜서 1 (음료를 뽑는다) -->
  <div id="dispenser1" class="hidden">
  <p><span style="font-weight: bold;">[레스토랑]/[음료 디스펜서]</span><br><br>
  원하는 음료를 가져가거나 랜덤 디스펜서를 이용해 보자. 랜덤 디스펜서는 1일 3회 사용 제한이 있다.</p>
  <button onclick="selectDrink('coke')">콜라</button>
  <button onclick="selectDrink('melon')">메론 소다</button>
  <button onclick="selectDrink('boricha')">보리차</button>
  <button onclick="selectRandomDrink()">랜덤</button>
  <p id="drink-result" style="margin-top: 2em; font-weight: bold;"></p>
  <button class="nav-button" onclick="goTo('dispenser')">나가기</button>
</div>

    <!-- 영화관 : 음료 디스펜서 2 (음료 공모전) -->
  <div id="dispenser2" class="hidden">
  <p><span style="font-weight: bold;">[레스토랑]/[음료 디스펜서]</span><br><br>
  "다음 주의 랜덤 음료 공모전 테마는... ＜좋아하는 사람의 마음을 사로잡기 위한 음료＞! <br>유언집행자 여러분의 많은 참여 바랍니다!"<br><br>...라고 쓰여 있다. 한 사람당 2개까지 응모 가능한 모양이다.</p>
   <input type="text" id="gongmo">
  <div id="gongmobox" style="display: block; margin-top: 1em;">
  <button onclick="addgongmo()">확인</button>
  </div>
    <p id="gongmo-result"></p>
  <button class="nav-button" onclick="goTo('dispenser')">나가기</button>
</div>

    <!-- 2층 --> 
    <div id="2ndfloor" class="hidden">
    <p><span style="font-weight: bold;">[2층]</span><br><br>왼쪽 복도는 내빈용 객실로, 오른쪽 복도는 회의실로 이어진다.<br>2층은 이미 둘러보았으니 다른 층을 확인하자.</p>
    <button onclick="goTo('elevator')">엘리베이터</button><br>
 </div>     
  
    <!-- 3층 --> 
    <div id="3rdfloor" class="hidden">
    <p><span style="font-weight: bold;">[3층]</span><br><br>3층으로 올라오면, 한눈에 봐도 굉장히 다채로운 시설이 있음을 확인할 수 있다.<br>여러 개의 방문에 반짝거리는 문패가 붙어 있는데, 그야말로 '문화생활'에 걸맞는 시설들이다.<br>창문 너머로는 섬의 모습이 내려다보인다.<br>저 멀리 메모리얼 파크에 묘비 세 개가 늘어서 있다...</p>
    <button onclick="goTo('elevator')">엘리베이터</button><br>
    <button onclick="goTo('music')">음악실</button>
    <button onclick="goTo('cinema')">영화관</button>
    <button onclick="goTo('art')">미술실</button><br>
    <button onclick="goTo('stage')">공연장</button>
    <button onclick="goTo('library')">도서관</button>
    <button onclick="goTo('lab')">자유연구실</button>
 </div>     

    <!-- 음악실 --> 
    <div id="music" class="hidden">
    <p><span style="font-weight: bold;">[음악실]</span><br><br>다양한 악기와 음반을 모아 둔 음악실. 전과 달라진 점은 없는 것 같다. 쓰러져 있었던 딥 블루의 CD가 다시 말끔히 세워져 있다.</p>
    <button class="nav-button" onclick="goTo('3rdfloor')">나가기</button>
  </div>

    <!-- 영화관 --> 
    <div id="cinema" class="hidden">
    <p><span style="font-weight: bold;">[영화관]</span><br><br>소규모지만, 제법 영화관 분위기가 나는 장소. 전과 크게 달라진 점은 없지만,<br><span style="color: #3f40d3;">"음료 디스펜서는 4층의 카페로 이전했습니다"</span> 라는 안내문이 붙어 있다.</p>
    <button class="nav-button" onclick="goTo('3rdfloor')">나가기</button>
    </div>   
  
    <!-- 미술실 --> 
    <div id="art" class="hidden">
    <p><span style="font-weight: bold;">[미술실]</span><br><br>예술적 소양을 함양할 수 있는 공간. 이곳저곳 이젤과 화구가 놓여 있다.<br>그동안 초세계급들이 그린 그림들이 초세계급 화가의 그림 옆에 나란히 전시되어 있다.</p>
    <button class="nav-button" onclick="goTo('3rdfloor')">나가기</button>
    </div>   
  
    <!-- 공연장 --> 
    <div id="stage" class="hidden">
    <p><span style="font-weight: bold;">[공연장]</span><br><br>원형 극장의 형태를 빌려온 공연장.<br>지금도 공연장 사용은 문제 없이 가능하지만, 보고 있으면 사건 현장이 떠오른다...</p>
    <button class="nav-button" onclick="goTo('3rdfloor')">나가기</button>
  </div>
  
    <!-- 도서관 --> 
    <div id="library" class="hidden">
    <p><span style="font-weight: bold;">[도서관]</span><br><br>장서의 종류별로 정리된 책장이 숲처럼 펼쳐진다.<br>지식의 보고라고 불리기에 손색없을 정도의 대형 도서관.<span style="color: #3f40d3;">책장</span>에서 책을 고를 수 있을 것 같다.<br>각 서가의 추천도서를 새로 구비했다는 안내문이 붙어 있다.</p>
    <button onclick="goTo('bookshelf')">책장</button><br>
    <button class="nav-button" onclick="goTo('3rdfloor')">나가기</button>
    </div>   

    <!-- 책장 --> 
    <div id="bookshelf" class="hidden">
    <p><span style="font-weight: bold;">[도서관]/[책장]</span><br><br>다양한 언어의 책이 꽂혀 있는 책장.<br>쉽게 읽을 수 있는 책들도 있고, 전공자가 아니면 이해할 수 없는 수준의 전문서적도 있다.<br>평생 책만 읽어도 다 읽어치울 수 없을 것 같은 양이다.<br>서가별로 추천도서도 모아 둔 모양인데, 한번 책을 골라 볼까?</p>
    <button onclick="goTo('bookshelf1')">종교 서가의 추천도서</button>
    <button onclick="goTo('bookshelf4')">문학 서가의 추천도서</button>
    <button onclick="goTo('bookshelf2')">아동문학 서가의 추천도서</button><br>
    <button onclick="goTo('bookshelf3')">철학 서가의 추천도서</button>
    <button onclick="goTo('bookshelf5')">자연과학 서가의 추천도서</button>
    <button onclick="goTo('bookshelf6')">사회과학 서가의 추천도서</button><br>
    <button class="nav-button" onclick="goTo('library')">나가기</button>
    </div>   

    <!-- 책장 --> 
    <div id="bookshelf1" class="hidden">
    <p><span style="font-weight: bold;">[도서관]/[책장]</span><br><br>종교 서가의 추천도서는...<br>한국의 민간 신앙인 무속신앙에 대해 정리해 둔 책이다.<br>귀신을 쫓는 방법 중에는 구타를 가하는 '구타법' 이라는 것도 있다고 한다.</p>
    <button class="nav-button" onclick="goTo('bookshelf')">나가기</button>
    </div>   

      <!-- 책장 --> 
    <div id="bookshelf4" class="hidden">
    <p><span style="font-weight: bold;">[도서관]/[책장]</span><br><br>문학 서가의 추천도서는...<br>'기억이란 무엇인가?' 라는 제목의 책.<br>한 번 잊어버린 기억을 떠올리는 것에 대한 다양한 관점을 소개하고 있다.</p>
    <button class="nav-button" onclick="goTo('bookshelf')">나가기</button>
    </div>   

  
    <!-- 책장 --> 
    <div id="bookshelf2" class="hidden">
    <p><span style="font-weight: bold;">[도서관]/[책장]</span><br><br>문학 서가의 추천도서는...<br>'괴물이 잠든 눈' 이라는 소설이다.<br>작가의 이름은 리반 에케로스.</p>
    <button class="nav-button" onclick="goTo('bookshelf')">나가기</button>
    </div>   

    <!-- 책장 --> 
    <div id="bookshelf3" class="hidden">
    <p><span style="font-weight: bold;">[도서관]/[책장]</span><br><br>철학 서가의 추천도서는...<br>'기억이란 무엇인가?' 라는 제목의 책.<br>한 번 잊어버린 기억을 떠올리는 것에 대한 다양한 관점을 소개하고 있다.</p>
    <button class="nav-button" onclick="goTo('bookshelf')">나가기</button>
    </div>   

  
    <!-- 책장 --> 
    <div id="bookshelf5" class="hidden">
    <p><span style="font-weight: bold;">[도서관]/[책장]</span><br><br>자연과학 서가의 추천도서는...<br>밤하늘의 다양한 별들을 찾는 방법을 알기 쉽게 설명한 책이다.<br>작은곰자리에 속한 북극성을 설명한 페이지에 책갈피가 꽂혀 있다.</p>
    <button class="nav-button" onclick="goTo('bookshelf')">나가기</button>
    </div>   

  
    <!-- 책장 --> 
    <div id="bookshelf6" class="hidden">
    <p><span style="font-weight: bold;">[도서관]/[책장]</span><br><br>사회과학 서가의 추천도서는...<br>대도시에서 발생하는 소매치기 문제에 대해 다룬 책.<br>소매치기가 가장 많은 도시로 꼽힌 곳은 바르셀로나. 프랑스 파리는 5위에 올라 있다.</p>
    <button class="nav-button" onclick="goTo('bookshelf')">나가기</button>
    </div>   
  
    <!-- 자유연구실 --> 
    <div id="lab" class="hidden">
    <p><span style="font-weight: bold;">[자유연구실]</span><br><br>학자와 연구자들을 위한 자유연구실.<br>전과 크게 달라진 점은 없다.</p>
    <button class="nav-button" onclick="goTo('3rdfloor')">나가기</button>
    </div>   
    
<!-- !!!!여기서부터 스크립트!!!! -->
  <script>
  // 애니메이션이 끝난 뒤 hover 작동 허용
  document.querySelectorAll('.menu-button').forEach(button => {
    button.addEventListener('animationend', () => {
      button.style.pointerEvents = 'auto';
    });
  });
//★★★★★[중요]유저 데이터★★★★★
    const userData = {
      mung0515: {
        class: "피자마스터 으믕",
        id: "ThePizzaMaster",
        STR: 6,
        INT: 6,
        OBS: 6,
        POW: 6,
        LUC: 6,
        key: 0,
        coin: 0
      },
      sese0409: {
        class: "감자마스터 세세",
        id: "Linguistics",
        STR: 1,
        INT: 1,
        OBS: 1,
        POW: 1,
        LUC: 1,
        key: 0,
        coin: 0
      },
        erne0409: {
        class: "재해과학자 에르네스토 프로켈",
        id: "NoClassToday",
        STR: 3,
        INT: 3,
        OBS: 3,
        POW: 3,
        LUC: 3,
        key: 0,
        coin: 0
      },
        liva3561: {
        class: "예언가 리반 에케로스",
        id: "Untitled",
        STR: 3,
        INT: 3,
        OBS: 3,
        POW: 3,
        LUC: 3,
        key: 0,
        coin: 0}
      ,
              taei0515: {
        class: "퇴마사 태이",
        id: "Taei",
        STR: 5,
        INT: 1,
        OBS: 1,
        POW: 3,
        LUC: 5,
        key: 0,
        coin: 0}
      ,
        pola2469: {
        class: "프론트맨 폴라리스 래피드",
        id: "polaris",
        STR: 5,
        INT: 4,
        OBS: 4,
        POW: 1,
        LUC: 5,
        key: 0,
        coin: 0}
      ,
        siny1538: {
        class: "약사 요시다 신",
        id: "SIN",
        STR: 2,
        INT: 5,
        OBS: 3,
        POW: 4,
        LUC: 2,
        key: 0,
        coin: 0}
      ,
        edit9947: {
        class: "과학수사관 에디트 발랑틴",
        id: "edit",
        STR: 4,
        INT: 4,
        OBS: 4,
        POW: 4,
        LUC: 4,
        key: 0,
        coin: 0}
      ,
        maur3085: {
        class: "소매치기 모리스 레비",
        id: "Levi",
        STR: 3,
        INT: 2,
        OBS: 4,
        POW: 2,
        LUC: 4,
        key: 0,
        coin: 0}
      ,
        jaha4287: {
        class: "스포츠 트레이너 원자한",
        id: "Jahan",
        STR: 4,
        INT: 4,
        OBS: 6,
        POW: 3,
        LUC: 2,
        key: 0,
        coin: 0}
      ,
        wied6391: {
        class: "필체감정사 비더 바이나흐텐",
        id: "WEIHNACHT",
        STR: 1,
        INT: 4,
        OBS: 6,
        POW: 1,
        LUC: 2,
        key: 0,
        coin: 0}
      ,
        isad2597: {
        class: "행정가 이사도르 도슨",
        id: "FT06_dawson",
        STR: 3,
        INT: 4,
        OBS: 5,
        POW: 6,
        LUC: 3,
        key: 0,
        coin: 0}
      ,
        zede0753: {
        class: "생존전문가 제더카이어 어비스",
        id: "AtoZ",
        STR: 5,
        INT: 3,
        OBS: 5,
        POW: 5,
        LUC: 3,
        key: 0,
        coin: 0}
      ,
        akir2740: {
        class: "화가 에이즈카 아키라",
        id: "akila",
        STR: 1,
        INT: 5,
        OBS: 5,
        POW: 5,
        LUC: 4,
        key: 0,
        coin: 0},
              rust8164: {
        class: "우체부 루스티카 테일윈드",
        id: "RUSTIC4",
        STR: 4,
        INT: 1,
        OBS: 4,
        POW: 3,
        LUC: 5,
        key: 0,
        coin: 0},
              seto2566: {
        class: "피아니스트 세토 아이비",
        id: "IVY",
        STR: 3,
        INT: 4,
        OBS: 5,
        POW: 3,
        LUC: 2,
        key: 0,
        coin: 0},
              kuki4917: {
        class: "해커 쿠루미 J. 쿠로키",
        id: "MACHO_KUKI",
        STR: 3,
        INT: 5,
        OBS: 4,
        POW: 3,
        LUC: 1,
        key: 0,
        coin: 0},
              nuri2925: {
        class: "체스마스터 하누리",
        id: "nuriNOW",
        STR: 1,
        INT: 4,
        OBS: 3,
        POW: 5,
        LUC: 4,
        key: 0,
        coin: 0},
              rose1928: {
        class: "수영선수 미아 콜린스",
        id: "RosePinkDolphin",
        STR: 4,
        INT: 2,
        OBS: 5,
        POW: 4,
        LUC: 3,
        key: 0,
        coin: 0},
              ivan2992: {
        class: "수의사 이반 카르포프",
        id: "ivan",
        STR: 4,
        INT: 5,
        OBS: 5,
        POW: 3,
        LUC: 2,
        key: 0,
        coin: 0},
              bury5792: {
        class: "고고학자 스트로 베리",
        id: "Berry",
        STR: 5,
        INT: 5,
        OBS: 5,
        POW: 5,
        LUC: 5,
        key: 0,
        coin: 0},
                 fome0838: {
        class: "탐험가 포멜하우트 에빌라",
        id: "Explorer",
        STR: 5,
        INT: 3,
        OBS: 3,
        POW: 5,
        LUC: 2,
        key: 0,
        coin: 0} 
    };

    let currentUser = null;
    let pageHistory = [];
    const outputIds = ['gym-result', 'library-result'];
    
//★★★★★로그인★★★★★
    function checkLogin() {
      const id = document.getElementById('id-input').value;
      if (userData[id]) {
        currentUser = userData[id];
        showWelcomeMessage(currentUser.class);
      } else {
        document.getElementById('login-error').innerText = "아이디가 일치하지 않습니다.";
      }
    }
  
//★★★★★환영 메시지★★★★★
    function showWelcomeMessage(userClass) {
      document.getElementById('login-page').classList.add('hidden');
      const container = document.createElement('div');
      container.classList.add('typewriter');
      container.innerHTML = `초세계급 ${userClass} 님을 환영합니다. . .`;
      document.body.appendChild(container);
      setTimeout(() => {
        container.remove();
        showUserInfo();
        document.getElementById('main-page').classList.remove('hidden');
        pageHistory.push('main-page');
      }, 3600);
    }
//★★★★★유저 인포메이션 창★★★★★
    function showUserInfo() {
      const userBox = document.getElementById('user-display');
      document.getElementById('user-class-line').innerHTML = `User ID: ${currentUser.id}`;
      document.getElementById('coin-line').innerText = `Coin: ${currentUser.coin || 0}`;
      userBox.classList.remove('hidden');
    }
    function updateCoinDisplay() {
      document.getElementById('coin-line').innerText = `Coin: ${currentUser.coin || 0}`;
    }
//★★★★★출력된 텍스트 아웃풋 창 넘어갈 때 지우기 (goTo 연동용)★★★★★
    function clearOutputs() {
      outputIds.forEach(id => {
        const el = document.getElementById(id);
        if (el) el.innerText = '';
      });
    }

//★★★★★goTo★★★★★
function goTo(page) {
  // 창 이동시 숨겨지지 않는 디스플레이 설정
  const exceptions = ['user-display','persistent-nav','bgm-player','bgm-player button'];  
  document.querySelectorAll('div').forEach(div => {
    const isException = exceptions.includes(div.id) || div.closest('#user-display') || div.closest('#persistent-nav');
    if (!isException) {
      div.classList.add('hidden');
    }
  });
  //지우고 페이드 인
  const target = document.getElementById(page);
  target.classList.remove('hidden');
  target.classList.add('fade-in');
  clearOutputs();
  pageHistory.push(page);
  //[중요]특정 페이지 진입 시 스탯(코인 등)변동
  if (['onstage3','recording4','recording5','trashcan','seat4'].includes(page)) {
    currentUser.coin = (currentUser.coin || 0) + 1;
    updateCoinDisplay();
  }
  if (['onstage2','notary5'].includes(page)) {
    currentUser.coin = (currentUser.coin || 0) + 2;
    updateCoinDisplay();
  }
  if (['cdlist2'].includes(page)) {
    currentUser.cd = 1;
    updateCoinDisplay();
  }
    if (['atlier1'].includes(page)) {
    currentUser.art = 1;
    updateCoinDisplay();
  }
    if (['makeup3'].includes(page)) {
    currentUser.acc = "토끼 머리띠";
    updateCoinDisplay();
  }
      if (['makeup4'].includes(page)) {
    currentUser.acc = "고양이 머리띠";
    updateCoinDisplay();
  }
      if (['makeup5'].includes(page)) {
    currentUser.acc = "다람쥐 머리띠";
    updateCoinDisplay();
  }
    if (['recording2'].includes(page)) {
    currentUser.music = "발라드를";
    updateCoinDisplay();
  }
      if (['recording3'].includes(page)) {
    currentUser.music = "댄스곡을";
    updateCoinDisplay();
  }
        if (['onecut2'].includes(page)) {
    currentUser.photo = "당당한";
    updateCoinDisplay();
  }
        if (['onecut3'].includes(page)) {
    currentUser.photo = "사랑스러운";
    updateCoinDisplay();
  }
        if (['onecut4'].includes(page)) {
    currentUser.photo = "무난한";
    updateCoinDisplay();
  }
    if (page === 'starting-point') {
    document.getElementById('persistent-nav').style.display = 'flex';
  }
if (page === 'recording4') {
  const scoreEl = document.getElementById('recording-score-4');
  if (scoreEl) scoreEl.innerText = `${Math.floor(Math.random() * 101)}점!`;
}
if (page === 'recording5') {
  const scoreEl = document.getElementById('recording-score-5');
  if (scoreEl) scoreEl.innerText = `${Math.floor(Math.random() * 101)}점!`;
}

  //얘네는 버튼 없애기용인데 이렇게 하지 말고 goTodel 사용을 고려할 것 ...
  const flowerButton = document.getElementById('flower-button-box');
if (flowerButton) {
  // 한 번이라도 헌화한 경우에는 다시 보이지 않음
  flowerButton.style.display = (page === 'flowerpage') ? 'none' : 'block';
}
  const codebox = document.getElementById('codebox');
if (page === 'notary4' && codebox) {
  const alreadyUsed = codebox.getAttribute('data-used') === 'true';
  codebox.style.display = alreadyUsed ? 'none' : 'block';
}
  document.getElementById('user-display').classList.remove('hidden');
}
  

//★★★★★goTodel(이동과 동시에 버튼 삭제)★★★★★   
function goTodel(targetPage, buttonId) {
  const btn = document.getElementById(buttonId);
  if (btn) btn.remove(); // 한 번만 지움
  goTo(targetPage); // 기존 페이지 이동 로직 재사용
}

//★★★★★goToWithSound(페이지 이동 버튼 누를 때 효과음(일시) 재생)★★★★★   
  function goToWithSound(page, soundFile) {
      const audio = new Audio(soundFile);
      audio.loop = false;
      audio.volume = 0.3;
      audio.play();
      goTo(page);
    }

//★★★★★goToWithSound(페이지 이동 버튼 누를 때 효과음 계속해서 재생, 루프)★★★★★  
let zzapseaAudio = null;
let zzapportAudio = null;

function goToWithSoundNL(page, soundFile) {
  if (soundFile.includes('zzapsea.mp3')) {
    zzapseaAudio = new Audio(soundFile);
    zzapseaAudio.loop = true;
    zzapseaAudio.play();
  } else if (soundFile.includes('zzapport.mp3')) {
    zzapportAudio = new Audio(soundFile);
    zzapportAudio.loop = true;
    zzapportAudio.play();
  } else {
    const audio = new Audio(soundFile);
    audio.loop = true;
    audio.play();
  }
  goTo(page);
}

//★★★★★해당 버튼을 누를 시, 페이지 이동과 동시에 zzapseaAudio 중지★★★★★
function goToWithoutzzapsea(page) {
  if (zzapseaAudio && !zzapseaAudio.paused) {
    zzapseaAudio.pause();
    zzapseaAudio.currentTime = 0;
  }
  if (zzapportAudio && !zzapportAudio.paused) {
    zzapportAudio.pause();
    zzapportAudio.currentTime = 0;
  }
  goTo(page);
}

//★★★★★goBack★★★★★  
function goBack() {
  if (pageHistory.length > 1) {
    // 현재 페이지 제거
    pageHistory.pop();
    const prevPage = pageHistory[pageHistory.length - 1];

    // 예외 요소들 (루트 + 내부 포함 전부 보호)
    const persistentRoots = ['user-display', 'bgm-player', 'persistent-nav'];

    // 모든 div를 숨기되, 예외 요소 또는 그 자식은 숨기지 않음
    document.querySelectorAll('div').forEach(div => {
      const isPersistent = persistentRoots.some(rootId => {
        const rootEl = document.getElementById(rootId);
        return rootEl && (div === rootEl || rootEl.contains(div));
      });
      if (!isPersistent) {
        div.classList.add('hidden');
      }
    });

    // 이전 페이지 보여주기
    const target = document.getElementById(prevPage);
    if (target) {
      target.classList.remove('hidden');
      target.classList.add('fade-in');
    }

    // 텍스트 강제 갱신 (혹시라도 브라우저 캐시가 날려버린 경우)
    if (currentUser) {
      const idLine = document.getElementById('user-class-line');
      const coinLine = document.getElementById('coin-line');
      if (idLine) idLine.innerText = `User ID: ${currentUser.id}`;
      if (coinLine) coinLine.innerText = `Coin: ${currentUser.coin || 0}`;
    }

    // 출력 영역 초기화
    clearOutputs();
  }
}




//여기서부터 특정 장소에서 사용하도록 되어 있는 함수!!!!
//★★★★★CD★★★★★
function listencd(buttonId) {
  if (currentUser.cd === 1) {
    // 버튼 제거
    const btn = document.getElementById(buttonId);
    if (btn) btn.remove();  // 단 한 번만 제거
    goTo('cd1');
  } else {
    alert("CD를 가지고 있지 않다. 골라 오도록 하자.");
  }
}

//★★★★★머리띠★★★★★
function dodo(buttonId) {
  if (currentUser.acc) {
    // 버튼 제거
    const btn = document.getElementById(buttonId);
    if (btn) btn.remove();  // 단 한 번만 제거
    goTo('mudae1');
  } else {
    alert("준비물이 부족하다. 작은 종이의 내용을 읽어 보자.");
  }
}

//★★★★공연하기★★★★
function onstage(buttonId) {
  if (currentUser.POW <= 2) {
    goTo('onstage1');
  } else if (currentUser.POW >= 4) {
    goTo('onstage2');
  } else {
    goTo('onstage3');
  }
    const btn = document.getElementById(buttonId);
    if (btn) btn.remove()  // 단 한 번만 제거
}
    
//★★★★★퀴즈★★★★★
function checkSecretCode() {
  const input = document.getElementById('secret-code-input').value;
  if (input === "초세계급이 재능을 숨김") { // 원하는 정답
    const codebox = document.getElementById('codebox');
    if (codebox) {
      codebox.style.display = 'none';
      codebox.setAttribute('data-used', 'true');  // ✅ 한 번 사용했음을 표시
    }
    goTo('notary5');
  } else {
    const result = document.getElementById('secret-code-result');
    result.innerText = "공증인은 침묵하고 있다... 아무래도 이게 정답이 아닌 것 같다.";
  }
}    
//★★★★★강한자의좌석★★★★★
function strongseat(buttonId) {
  if (currentUser.STR <= 2) {
    goTo('seat2');
  } else if (currentUser.STR >= 4) {
    goTo('seat4');
  } else {
    goTo('seat3');
  }
    const btn = document.getElementById(buttonId);
    if (btn) btn.remove()  // 단 한 번만 제거
}

//★★★★팝콘뽑기★★★★
function getpopcorn(buttonId) {
  if (currentUser.LUC <= 2) {
    goTo('pop1');
  } else if (currentUser.LUC >= 4) {
    goTo('pop2');
  } else {
    goTo('pop3');
  }
    const btn = document.getElementById(buttonId);
    if (btn) btn.remove()  // 단 한 번만 제거
}

//★★★★★음료 디스펜서★★★★★
// 음료 효과음 공통
let drinkAudio = new Audio("zzapdrink.mp3");
function playDrinkSound() {
  drinkAudio.pause();
  drinkAudio.currentTime = 0;
  drinkAudio.play();
}
// 일반 음료 선택 함수
function selectDrink(type) {
  const messages = {
    coke: { title: "콜라", desc: "영화관에서는 콜라! 팝콘과의 궁합을 자랑하는 시원한 음료." },
    "melon": { title: "메론 소다", desc: "약간의 인공적인 메론 향이 오히려 매력적인 탄산음료." },
    "boricha": { title: "보리차", desc: "건강한 어른을 위한 무난한 음료." }
  };
  const msg = messages[type];
  const resultBox = document.getElementById("drink-result");
  resultBox.innerHTML = `<p><span style="font-weight: bold;">[${msg.title}]</span><br><br>${msg.desc}</p>`;
  // 애니메이션 적용
  resultBox.style.animation = "none";
  void resultBox.offsetWidth;
  resultBox.style.animation = "pop 0.6s ease-out";
  playDrinkSound();
}
//랜덤 음료
let randomClickCount = 0;
const randomLimit = 3;
function selectRandomDrink() {
  if (randomClickCount >= randomLimit) {
    document.getElementById("drink-result").innerText = "오늘의 사용 횟수를 초과한 모양이다.";
    return;
  }
  const messages = [
    { title: "간장 콜라", desc: "추천인 : 제더카이어 어비스" },
    { title: "유니콘 프라페", desc: "추천인 : 미아 콜린스" },
    { title: "된장국", desc: "추천인 : 미아 콜린스" },
    { title: "괴상한 음료에 지친 당신을 치료해 줄 비타500", desc: "추천인 : 요시다 신" },
    { title: "목넘김이 깔끔한 생수", desc: "추천인 : 요시다 신" },
    { title: "탄산팥죽", desc: "추천인 : 스트로 베리" },
    { title: "밴드 딥 블루가 그려진 캔커피", desc: "추천인 : 스트로 베리" },
    { title: "위스키", desc: "추천인 : 이반 카르포프" },
    { title: "보드카", desc: "추천인 : 이반 카르포프" },
    { title: "누리표 누리자 에너지음료", desc: "추천인 : 하누리" },
    { title: "누리표 복수의 붉은맛(※딸기맛)", desc: "추천인 : 하누리" },
    { title: "팥맛 소다", desc: "추천인 : 폴라리스 래피드" },
    { title: "두리안 주스", desc: "추천인 : 폴라리스 래피드" },
    { title: "코코아", desc: "추천인 : 루스티카 테일윈드" },
    { title: "딸기라떼", desc: "추천인 : 루스티카 테일윈드" },
    { title: "아이스 위스키 커피", desc: "추천인 : 포멜하우트 에빌라" },
    { title: "코코넛 간장 스무디", desc: "추천인 : 포멜하우트 에빌라" },
    { title: "딸기잼", desc: "추천인 : ?" },
    { title: "테트로도톡신 10mg", desc: "추천인 : 에디트 발랑틴" },
    { title: "물 6L", desc: "추천인 : 에디트 발랑틴" },
    { title: "아샷추", desc: "추천인 : 이사도르 도슨" },
    { title: "바닷물", desc: "추천인 : 에르네스토 프로켈" },
    { title: "마그마 라떼", desc: "추천인 : 에르네스토 프로켈" },
    { title: "팥절미 라떼", desc: "추천인 : 태이" }
  ];
  const randomIndex = Math.floor(Math.random() * messages.length);
  const msg = messages[randomIndex];
  const resultBox = document.getElementById("drink-result");
  resultBox.innerHTML = `<p><span style="font-weight: bold;">[${msg.title}]</span><br><br>${msg.desc}</p>`;
  // 애니메이션 재적용
  resultBox.style.animation = "none";
  void resultBox.offsetWidth;
  resultBox.style.animation = "pop 0.6s ease-out";
  playDrinkSound();
  // 클릭 횟수 증가
  randomClickCount++;
  if (randomClickCount >= randomLimit) {
    document.getElementById("random-button").disabled = true;
    document.getElementById("random-button").innerText = "사용 불가";
  }
}

//랜덤음료공모전
function addgongmo() {
  const input = document.getElementById('gongmo').value.trim();
  // currentUser.gongmo가 없다면 초기화
  if (!currentUser.gongmo) {
    currentUser.gongmo = [];
  }
  // 2번 이상 제출 시 제한
  if (currentUser.gongmo.length >= 2) {
    alert("이미 공모전에 음료를 제출했습니다!");
    return;
  }
  if (input === "") {
    alert("음료 이름을 입력해 주세요.");
    return;
  }
  // 제출 처리
  currentUser.gongmo.push(input);
  document.getElementById('gongmo-result').innerText = "공모전에 음료를 제출했습니다.";
  document.getElementById('gongmo').value = "";
}

  </script>
<script src="final-report.js"></script>
</body>
</html>
